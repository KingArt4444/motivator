{"ast":null,"code":"var _jsxFileName = \"E:\\\\\\u0423\\u0447\\u0451\\u0431\\u0430\\\\4 \\u043A\\u0443\\u0440\\u0441\\\\kurswatch7-front\\\\src\\\\component\\\\AllowancePopFormComponent.jsx\";\nimport React, { Component } from 'react';\nimport { Formik, Form, Field, ErrorMessage } from 'formik'; // import PopPop from './node_modules/react-poppop/lib/index';\n\nimport AllowancesDataService from '../service/AllowancesDataService';\nimport { hashHistory } from 'react-router;';\n\nconst PopPop = require('react-poppop');\n\nexport default class AllowancePopFormComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.toggleShow = show => {\n      this.setState({\n        show\n      });\n    };\n\n    this.state = {\n      id: this.props.id,\n      type: '',\n      date: '',\n      rate: '',\n      sum: '',\n      distribution: '',\n      period: '',\n      user: {\n        id: this.props.userId\n      },\n      show: false\n    };\n    this.onSubmit = this.onSubmit.bind(this);\n    this.validate = this.validate.bind(this); // this.handleStatusDropdownChange = this.handleStatusDropdownChange.bind(this)\n    // this.handleEducationDropdownChange = this.handleEducationDropdownChange.bind(this)\n    // this.handleEducationPlaceDropdownChange = this.handleEducationPlaceDropdownChange.bind(this)\n  }\n\n  componentDidMount() {\n    console.log(this.state.id);\n    console.log(this.state.user.id); // eslint-disable-next-line\n\n    if (this.state.id == -1) {\n      return;\n    }\n\n    AllowancesDataService.retrieveAllowance(this.state.id).then(response => this.setState({\n      type: response.data.type,\n      date: response.data.date,\n      rate: response.data.rate,\n      sum: response.data.sum,\n      distribution: response.data.distribution,\n      period: response.data.period,\n      user: {\n        id: response.data.user.id\n      }\n    }));\n  }\n\n  onSubmit(values) {\n    let allowance = {\n      id: this.state.id,\n      type: values.type,\n      date: values.date,\n      rate: values.rate,\n      sum: values.sum,\n      distribution: values.distribution,\n      period: values.period,\n      user: {\n        id: this.state.user.id\n      }\n    };\n\n    if (values.id == -1) {\n      AllowancesDataService.createAllowance(allowance).then(() => {\n        this.toggleShow(false); // document.location.href = `/userdetails/${this.state.user.id}`;\n\n        hashHistory.push(\"/userdetails/\".concat(this.state.user.id)); // this.props.history.push(`/userdetails/${this.state.user.id}`)\n      });\n    } else {\n      AllowancesDataService.updateAllowance(this.state.id, allowance).then(() => this.props.history.push(\"/allowances\"));\n    }\n\n    console.log(values);\n  }\n\n  validate(values) {\n    let errors = {}; // if (values.type.length < 3) {\n    //   errors.type = 'Имя должно состоять минимум из 2-х букв'\n    // }\n    // if (!values.salary) {\n    //   errors.salary = 'Введите фамилию'\n    // }\n    // if (!values.premiya) {\n    //   errors.premiya = 'Фамилия должно состоять минимум из 2-х букв'\n    // }\n    // if (!values.sum) {\n    //   errors.sum = 'Введите возраст'\n    // }\n    // if (!values.month) {\n    //   errors.month = 'Введите месяц'\n    // }\n    // console.log(values.user)\n    // if (values.user.id === \"\") {\n    //   errors.user = 'Выберите сотрудника перед сохранением'\n    // }\n\n    return errors;\n  } // handleDropdownChange(e) {\n  //   this.setState({ user: e.target.value });\n  // }\n\n\n  render() {\n    const show = this.state.show;\n    let _this$state = this.state,\n        id = _this$state.id,\n        type = _this$state.type,\n        date = _this$state.date,\n        rate = _this$state.rate,\n        sum = _this$state.sum,\n        distribution = _this$state.distribution,\n        period = _this$state.period,\n        user = _this$state.user;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-success\",\n      onClick: () => this.toggleShow(true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"), React.createElement(PopPop, {\n      position: \"centerCenter\",\n      open: show,\n      closeBtn: true,\n      closeOnEsc: true,\n      onClose: () => this.toggleShow(false),\n      closeOnOverlay: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"\\u041D\\u0430\\u0434\\u0431\\u0430\\u0432\\u043A\\u0430\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(Formik, {\n      initialValues: {\n        id,\n        type,\n        date,\n        rate,\n        sum,\n        distribution,\n        period,\n        user\n      },\n      onSubmit: this.onSubmit,\n      validateOnChange: false,\n      validateOnBlur: false,\n      validate: this.validate,\n      enableReinitialize: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, props => React.createElement(Form, {\n      id: \"form\" // onChange={this.onFormChange}\n      ,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"Id\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"text\",\n      name: \"id\",\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"\\u0422\\u0438\\u043F \\u043D\\u0430\\u0434\\u0431\\u0430\\u0432\\u043A\\u0438\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"text\",\n      name: \"type\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"\\u0414\\u0430\\u0442\\u0430\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"date\",\n      name: \"date\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"\\u041F\\u0440\\u043E\\u0446\\u0435\\u043D\\u0442\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"number\",\n      name: \"rate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"\\u0421\\u0443\\u043C\\u043C\\u0430\\u0440\\u043D\\u043E\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"number\",\n      name: \"sum\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430\\u0435\\u0442 \\u043F\\u043E \\u0440\\u0430\\u0441\\u043F\\u0440\\u0435\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u044E\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"text\",\n      name: \"distribution\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(\"fieldset\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\"), React.createElement(Field, {\n      className: \"form-control\",\n      type: \"text\",\n      name: \"period\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      className: \"btn btn-success\",\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\")))))));\n  }\n\n}","map":{"version":3,"sources":["E:/Учёба/4 курс/kurswatch7-front/src/component/AllowancePopFormComponent.jsx"],"names":["React","Component","Formik","Form","Field","ErrorMessage","AllowancesDataService","hashHistory","PopPop","require","AllowancePopFormComponent","constructor","props","toggleShow","show","setState","state","id","type","date","rate","sum","distribution","period","user","userId","onSubmit","bind","validate","componentDidMount","console","log","retrieveAllowance","then","response","data","values","allowance","createAllowance","push","updateAllowance","history","errors","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,MAAT,EAAiBC,IAAjB,EAAuBC,KAAvB,EAA8BC,YAA9B,QAAkD,QAAlD,C,CACA;;AACA,OAAOC,qBAAP,MAAkC,kCAAlC;AACA,SAASC,WAAT,QAA4B,eAA5B;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAAC,cAAD,CAAtB;;AAGA,eAAe,MAAMC,yBAAN,SAAwCT,SAAxC,CAAkD;AAC/DU,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SA2GnBC,UA3GmB,GA2GNC,IAAI,IAAI;AACnB,WAAKC,QAAL,CAAc;AAAED,QAAAA;AAAF,OAAd;AACD,KA7GkB;;AAEjB,SAAKE,KAAL,GAAa;AACXC,MAAAA,EAAE,EAAE,KAAKL,KAAL,CAAWK,EADJ;AAEXC,MAAAA,IAAI,EAAE,EAFK;AAGXC,MAAAA,IAAI,EAAE,EAHK;AAIXC,MAAAA,IAAI,EAAE,EAJK;AAKXC,MAAAA,GAAG,EAAE,EALM;AAMXC,MAAAA,YAAY,EAAE,EANH;AAOXC,MAAAA,MAAM,EAAE,EAPG;AAQXC,MAAAA,IAAI,EAAE;AACJP,QAAAA,EAAE,EAAE,KAAKL,KAAL,CAAWa;AADX,OARK;AAWXX,MAAAA,IAAI,EAAE;AAXK,KAAb;AAcA,SAAKY,QAAL,GAAgB,KAAKA,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKC,QAAL,GAAgB,KAAKA,QAAL,CAAcD,IAAd,CAAmB,IAAnB,CAAhB,CAjBiB,CAkBjB;AACA;AACA;AACD;;AACDE,EAAAA,iBAAiB,GAAG;AAElBC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKf,KAAL,CAAWC,EAAvB;AACAa,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKf,KAAL,CAAWQ,IAAX,CAAgBP,EAA5B,EAHkB,CAKlB;;AACA,QAAI,KAAKD,KAAL,CAAWC,EAAX,IAAiB,CAAC,CAAtB,EAAyB;AACvB;AACD;;AAEDX,IAAAA,qBAAqB,CAAC0B,iBAAtB,CAAwC,KAAKhB,KAAL,CAAWC,EAAnD,EACGgB,IADH,CACQC,QAAQ,IAAI,KAAKnB,QAAL,CAAc;AAC9BG,MAAAA,IAAI,EAAEgB,QAAQ,CAACC,IAAT,CAAcjB,IADU;AAE9BC,MAAAA,IAAI,EAAEe,QAAQ,CAACC,IAAT,CAAchB,IAFU;AAG9BC,MAAAA,IAAI,EAAEc,QAAQ,CAACC,IAAT,CAAcf,IAHU;AAI9BC,MAAAA,GAAG,EAAEa,QAAQ,CAACC,IAAT,CAAcd,GAJW;AAK9BC,MAAAA,YAAY,EAAEY,QAAQ,CAACC,IAAT,CAAcb,YALE;AAM9BC,MAAAA,MAAM,EAAEW,QAAQ,CAACC,IAAT,CAAcZ,MANQ;AAO9BC,MAAAA,IAAI,EAAE;AACJP,QAAAA,EAAE,EAAEiB,QAAQ,CAACC,IAAT,CAAcX,IAAd,CAAmBP;AADnB;AAPwB,KAAd,CADpB;AAaD;;AAEDS,EAAAA,QAAQ,CAACU,MAAD,EAAS;AACf,QAAIC,SAAS,GAAG;AACdpB,MAAAA,EAAE,EAAE,KAAKD,KAAL,CAAWC,EADD;AAEdC,MAAAA,IAAI,EAAEkB,MAAM,CAAClB,IAFC;AAGdC,MAAAA,IAAI,EAAEiB,MAAM,CAACjB,IAHC;AAIdC,MAAAA,IAAI,EAAEgB,MAAM,CAAChB,IAJC;AAKdC,MAAAA,GAAG,EAAEe,MAAM,CAACf,GALE;AAMdC,MAAAA,YAAY,EAAEc,MAAM,CAACd,YANP;AAOdC,MAAAA,MAAM,EAAEa,MAAM,CAACb,MAPD;AAQdC,MAAAA,IAAI,EAAE;AACJP,QAAAA,EAAE,EAAE,KAAKD,KAAL,CAAWQ,IAAX,CAAgBP;AADhB;AARQ,KAAhB;;AAcA,QAAImB,MAAM,CAACnB,EAAP,IAAa,CAAC,CAAlB,EAAqB;AACnBX,MAAAA,qBAAqB,CAACgC,eAAtB,CAAsCD,SAAtC,EACGJ,IADH,CACQ,MAAM;AACV,aAAKpB,UAAL,CAAgB,KAAhB,EADU,CAEV;;AACAN,QAAAA,WAAW,CAACgC,IAAZ,wBAAiC,KAAKvB,KAAL,CAAWQ,IAAX,CAAgBP,EAAjD,GAHU,CAIV;AACD,OANH;AAOD,KARD,MAQO;AACLX,MAAAA,qBAAqB,CAACkC,eAAtB,CAAsC,KAAKxB,KAAL,CAAWC,EAAjD,EAAqDoB,SAArD,EACGJ,IADH,CACQ,MAAM,KAAKrB,KAAL,CAAW6B,OAAX,CAAmBF,IAAnB,eADd;AAED;;AAEDT,IAAAA,OAAO,CAACC,GAAR,CAAYK,MAAZ;AACD;;AAEDR,EAAAA,QAAQ,CAACQ,MAAD,EAAS;AACf,QAAIM,MAAM,GAAG,EAAb,CADe,CAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAOA,MAAP;AACD,GAtG8D,CAwG/D;AACA;AACA;;;AAMAC,EAAAA,MAAM,GAAG;AAAA,UACC7B,IADD,GACU,KAAKE,KADf,CACCF,IADD;AAAA,sBAEyD,KAAKE,KAF9D;AAAA,QAEDC,EAFC,eAEDA,EAFC;AAAA,QAEGC,IAFH,eAEGA,IAFH;AAAA,QAESC,IAFT,eAESA,IAFT;AAAA,QAEeC,IAFf,eAEeA,IAFf;AAAA,QAEqBC,GAFrB,eAEqBA,GAFrB;AAAA,QAE0BC,YAF1B,eAE0BA,YAF1B;AAAA,QAEwCC,MAFxC,eAEwCA,MAFxC;AAAA,QAEgDC,IAFhD,eAEgDA,IAFhD;AAIP,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAoC,MAAA,OAAO,EAAE,MAAM,KAAKX,UAAL,CAAgB,IAAhB,CAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0DADF,EAEE,oBAAC,MAAD;AAAQ,MAAA,QAAQ,EAAC,cAAjB;AACE,MAAA,IAAI,EAAEC,IADR;AAEE,MAAA,QAAQ,EAAE,IAFZ;AAGE,MAAA,UAAU,EAAE,IAHd;AAIE,MAAA,OAAO,EAAE,MAAM,KAAKD,UAAL,CAAgB,KAAhB,CAJjB;AAKE,MAAA,cAAc,EAAE,IALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0DADF,EAEE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AACE,MAAA,aAAa,EAAE;AAAEI,QAAAA,EAAF;AAAMC,QAAAA,IAAN;AAAYC,QAAAA,IAAZ;AAAkBC,QAAAA,IAAlB;AAAwBC,QAAAA,GAAxB;AAA6BC,QAAAA,YAA7B;AAA2CC,QAAAA,MAA3C;AAAmDC,QAAAA;AAAnD,OADjB;AAEE,MAAA,QAAQ,EAAE,KAAKE,QAFjB;AAGE,MAAA,gBAAgB,EAAE,KAHpB;AAIE,MAAA,cAAc,EAAE,KAJlB;AAKE,MAAA,QAAQ,EAAE,KAAKE,QALjB;AAME,MAAA,kBAAkB,EAAE,IANtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OASKhB,KAAD,IACE,oBAAC,IAAD;AAAM,MAAA,EAAE,EAAC,MAAT,CACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAeE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,IAAI,EAAC,IAAjD;AAAsD,MAAA,QAAQ,MAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAfF,EAmBE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6EADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,IAAI,EAAC,MAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAnBF,EAuBE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,IAAI,EAAC,MAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAvBF,EA2BE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oDADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,QAArC;AAA8C,MAAA,IAAI,EAAC,MAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CA3BF,EA+BE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0DADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,QAArC;AAA8C,MAAA,IAAI,EAAC,KAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CA/BF,EAmCE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sJADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,IAAI,EAAC,cAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAnCF,EAuCE;AAAU,MAAA,SAAS,EAAC,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kFADF,EAEE,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAC,cAAjB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,IAAI,EAAC,QAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAvCF,EA2CE;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAoC,MAAA,IAAI,EAAC,QAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gEA3CF,CAVN,CADF,CAFF,CANF,CAFF,CADF;AA4ED;;AAhM8D","sourcesContent":["import React, { Component } from 'react';\r\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\r\n// import PopPop from './node_modules/react-poppop/lib/index';\r\nimport AllowancesDataService from '../service/AllowancesDataService';\r\nimport { hashHistory } from 'react-router;'\r\nconst PopPop = require('react-poppop');\r\n\r\n\r\nexport default class AllowancePopFormComponent extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      id: this.props.id,\r\n      type: '',\r\n      date: '',\r\n      rate: '',\r\n      sum: '',\r\n      distribution: '',\r\n      period: '',\r\n      user: {\r\n        id: this.props.userId\r\n      },\r\n      show: false\r\n    }\r\n\r\n    this.onSubmit = this.onSubmit.bind(this)\r\n    this.validate = this.validate.bind(this)\r\n    // this.handleStatusDropdownChange = this.handleStatusDropdownChange.bind(this)\r\n    // this.handleEducationDropdownChange = this.handleEducationDropdownChange.bind(this)\r\n    // this.handleEducationPlaceDropdownChange = this.handleEducationPlaceDropdownChange.bind(this)\r\n  }\r\n  componentDidMount() {\r\n\r\n    console.log(this.state.id)\r\n    console.log(this.state.user.id)\r\n\r\n    // eslint-disable-next-line\r\n    if (this.state.id == -1) {\r\n      return\r\n    }\r\n\r\n    AllowancesDataService.retrieveAllowance(this.state.id)\r\n      .then(response => this.setState({\r\n        type: response.data.type,\r\n        date: response.data.date,\r\n        rate: response.data.rate,\r\n        sum: response.data.sum,\r\n        distribution: response.data.distribution,\r\n        period: response.data.period,\r\n        user: {\r\n          id: response.data.user.id\r\n        }\r\n      }))\r\n\r\n  }\r\n\r\n  onSubmit(values) {\r\n    let allowance = {\r\n      id: this.state.id,\r\n      type: values.type,\r\n      date: values.date,\r\n      rate: values.rate,\r\n      sum: values.sum,\r\n      distribution: values.distribution,\r\n      period: values.period,\r\n      user: {\r\n        id: this.state.user.id\r\n      }\r\n    }\r\n\r\n\r\n    if (values.id == -1) {\r\n      AllowancesDataService.createAllowance(allowance)\r\n        .then(() => {\r\n          this.toggleShow(false);\r\n          // document.location.href = `/userdetails/${this.state.user.id}`;\r\n          hashHistory.push(`/userdetails/${this.state.user.id}`);\r\n          // this.props.history.push(`/userdetails/${this.state.user.id}`)\r\n        })\r\n    } else {\r\n      AllowancesDataService.updateAllowance(this.state.id, allowance)\r\n        .then(() => this.props.history.push(`/allowances`))\r\n    }\r\n\r\n    console.log(values);\r\n  }\r\n\r\n  validate(values) {\r\n    let errors = {}\r\n    // if (values.type.length < 3) {\r\n    //   errors.type = 'Имя должно состоять минимум из 2-х букв'\r\n    // }\r\n    // if (!values.salary) {\r\n    //   errors.salary = 'Введите фамилию'\r\n    // }\r\n    // if (!values.premiya) {\r\n    //   errors.premiya = 'Фамилия должно состоять минимум из 2-х букв'\r\n    // }\r\n    // if (!values.sum) {\r\n    //   errors.sum = 'Введите возраст'\r\n    // }\r\n    // if (!values.month) {\r\n    //   errors.month = 'Введите месяц'\r\n    // }\r\n    // console.log(values.user)\r\n    // if (values.user.id === \"\") {\r\n    //   errors.user = 'Выберите сотрудника перед сохранением'\r\n    // }\r\n\r\n    return errors\r\n  }\r\n\r\n  // handleDropdownChange(e) {\r\n  //   this.setState({ user: e.target.value });\r\n  // }\r\n\r\n  toggleShow = show => {\r\n    this.setState({ show });\r\n  }\r\n\r\n  render() {\r\n    const { show } = this.state;\r\n    let { id, type, date, rate, sum, distribution, period, user } = this.state\r\n\r\n    return (\r\n      <div>\r\n        <button className=\"btn btn-success\" onClick={() => this.toggleShow(true)}>Добавить</button>\r\n        <PopPop position=\"centerCenter\"\r\n          open={show}\r\n          closeBtn={true}\r\n          closeOnEsc={true}\r\n          onClose={() => this.toggleShow(false)}\r\n          closeOnOverlay={true}>\r\n          <div>\r\n            <h3>Надбавка</h3>\r\n            <div className=\"container\">\r\n              <Formik\r\n                initialValues={{ id, type, date, rate, sum, distribution, period, user }}\r\n                onSubmit={this.onSubmit}\r\n                validateOnChange={false}\r\n                validateOnBlur={false}\r\n                validate={this.validate}\r\n                enableReinitialize={true}\r\n              >\r\n                {\r\n                  (props) => (\r\n                    <Form id=\"form\"\r\n                    // onChange={this.onFormChange}\r\n                    >\r\n                      {/* <ErrorMessage name=\"workdays\" component=\"div\"\r\n                    className=\"alert alert-warning\" />\r\n                  <ErrorMessage name=\"totalWorkdays\" component=\"div\"\r\n                    className=\"alert alert-warning\" />\r\n                  <ErrorMessage name=\"assessment\" component=\"div\"\r\n                    className=\"alert alert-warning\" />\r\n                  <ErrorMessage name=\"month\" component=\"div\"\r\n                    className=\"alert alert-warning\" />\r\n                  <ErrorMessage name=\"year\" component=\"div\"\r\n                    className=\"alert alert-warning\" />\r\n                  <ErrorMessage name=\"user\" component=\"div\"\r\n                    className=\"alert alert-warning\" /> */}\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Id</label>\r\n                        <Field className=\"form-control\" type=\"text\" name=\"id\" disabled />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Тип надбавки</label>\r\n                        <Field className=\"form-control\" type=\"text\" name=\"type\" />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Дата</label>\r\n                        <Field className=\"form-control\" type=\"date\" name=\"date\" />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Процент</label>\r\n                        <Field className=\"form-control\" type=\"number\" name=\"rate\" />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Суммарно</label>\r\n                        <Field className=\"form-control\" type=\"number\" name=\"sum\" />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Работает по распределению</label>\r\n                        <Field className=\"form-control\" type=\"text\" name=\"distribution\" />\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                        <label>Длительность</label>\r\n                        <Field className=\"form-control\" type=\"text\" name=\"period\" />\r\n                      </fieldset>\r\n                      <button className=\"btn btn-success\" type=\"submit\">Сохранить</button>\r\n                    </Form>\r\n                  )\r\n                }\r\n              </Formik>\r\n\r\n            </div>\r\n          </div>\r\n        </PopPop>\r\n      </div>\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}